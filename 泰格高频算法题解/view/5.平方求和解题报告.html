<div class="page-inner">
    <div id="book-search-results">
        <div class="search-noresults">
            <section class="normal markdown-section">
                <h1 id="5-平方求和题解">5. 平方求和题解</h1><pre data-initialized="true" data-gclp-id="231"><code> ___       _   _____
                (  _`\  _ ( )_(_   _)_                         _
                | (_) )(_)| ,_) | | (_)   __     __   _ __    (_)   _
                |  _ &lt;'| || |   | | | | /'_ `\ /'__`\( '__)   | | /'_`\
                | (_) )| || |_  | | | |( (_) |(  ___/| |    _ | |( (_) )
                (____/'(_)`\__) (_) (_)`\__  |`\____)(_)   (_)(_)`\___/'
                ( )_) |
                \___/'
            </code></pre>
                <h2 id="题目分析">题目分析</h2><ul><li>频率：4
            </li>
                <li>难度：2-3
                </li>
                <li>关键词：recursion, dynamic programming, math, depth first search, A* Search
                </li></ul>
                <h2 id="视频讲解">视频讲解</h2><div class="gb-video" data-videoid="203446"><div class="flowplayer is-splash is-mouseout is-paused" data-analytics="UA-68088696-2" data-rtmp="rtmp://rtmp.flowplayer.org/cfx/st/" data-ratio="0.6250" data-embed="false" data-flowplayer-instance-id="6" style="background-image: url(&quot;//cdn-i2.tianmaying.com/public/img/videosplash.png&quot;);">


                <div class="fp-ratio" style="padding-top: 56.25%;"></div><div class="fp-player"><div class="buttons">
                <span class="active">1x</span>
                <span>1.5x</span>
                <span>2x</span>
            </div><div class="endscreen text-center">


                <div class="vip-bg" style="margin-top: 15%; padding-bottom: 20px; box-shadow: none; margin-right: 10px; margin-left: 10px;">
                    <a href="/premiumMembership">
                        <div class="text-center">
                            <h1 class="vip-header" style="color:white; font-size:20px;"><strong>加入太阁VIP</strong></h1>
                        </div>

                        <div class="row wow fadeIn" data-wow-duration="1s" data-wow-delay="0.2s" style="padding-top: 20px; color: rgb(51, 122, 183); visibility: hidden; animation-duration: 1s; animation-delay: 0.2s; animation-name: none;">
                            <div class="col-md-3 col-sm-6 col-xs-12 text-center" style="padding:5px;">
                                <div style="display:inline-block; width:50px; height:50px;">
                                    <img src="//cdn-i2.tianmaying.com/public/img/icons/vipLarge.png" style="width:35px;">
                                </div>
                                <p style="font-size:15px; font-weight:bold; padding-left:15px;">太阁程序员面试宝典（算法设计、系统设计、数据科学、职业发展、实战项目）</p>
                            </div>
                            <div class="col-md-6 col-sm-12 col-xs-12 text-center" style="padding:5px;">
                                <span class="purple-microphone"></span>
                                <p style="font-size:15px; font-weight:bold;">VIP用户能够观看硅谷之路全部上百篇视频的完整版 VS 普通用户能够观看最近三天视频的完整版</p>
                            </div>
                            <div class="col-md-3 col-sm-6 col-xs-12 text-center" style="padding:5px;">
                                <span class="purple-discussion"></span>
                                <p style="font-size:15px; font-weight:bold; padding-right:15px;">支持太阁实验室推出更多更好的内容</p>
                            </div>
                        </div>
                    </a>
                </div>


                <a class="fp-toggle">Play video again</a>
            </div><div class="fp-ui" title="Hit ? for help">         <div class="fp-waiting"><em></em><em></em><em></em></div>         <a class="fp-fullscreen"></a>         <a class="fp-unload"></a>         <p class="fp-speed"></p>         <div class="fp-controls">            <a class="fp-play"></a>            <div class="fp-timeline">               <div class="fp-buffer"></div>               <div class="fp-progress animated" style="transition-duration: 0ms; width: 0%;"></div>            </div>            <div class="fp-timeline-tooltip fp-tooltip"></div>            <div class="fp-volume">               <a class="fp-mute"></a>               <div class="fp-volumeslider">                  <div class="fp-volumelevel"></div>               </div>            </div>         <a href="http://flowplayer.org" class="fp-brand">flowplayer</a></div>         <div class="fp-time">            <em class="fp-elapsed">00:00</em>            <em class="fp-remaining"></em>            <em class="fp-duration">00:00</em>         </div>         <div class="fp-message"><h2></h2><p></p></div></div><div class="fp-help">         <a class="fp-close"></a>         <div class="fp-help-section fp-help-basics">            <p><em>space</em>play / pause</p>            <p><em>q</em>unload | stop</p>            <p><em>f</em>fullscreen</p><p><em>shift</em> + <em>←</em><em>→</em>slower / faster</p>         </div>         <div class="fp-help-section">            <p><em>↑</em><em>↓</em>volume</p>            <p><em>m</em>mute</p>         </div>         <div class="fp-help-section">            <p><em>←</em><em>→</em>seek</p>            <p><em>&nbsp;. </em>seek to previous            </p><p><em>1</em><em>2</em>… <em>6</em> seek to 10%, 20% … 60% </p>         </div>   </div><div class="fp-context-menu"><ul><li class="copyright">© 2015</li><li><a href="http://flowplayer.org">About Flowplayer</a></li><li><a href="http://flowplayer.org/license">GPL based license</a></li></ul></div></div><a href="http://flowplayer.org" style="display: none;"></a></div></div>




                <h2 id="depth-first-search">Depth first search</h2><pre data-initialized="true" data-gclp-id="232"><code class="lang-java">
                <span class="hljs-keyword">import</span> java.io.*;
                <span class="hljs-keyword">import</span> java.util.*;


                <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Perfect</span></span>{
                <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">search</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span>{
                <span class="hljs-comment">// input: n</span>
                <span class="hljs-comment">// output: the MIN number of perfect numbers summed as n</span>
                <span class="hljs-keyword">int</span> result = n;

                <span class="hljs-comment">//        System.out.println(n);</span>

                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>; i*i&lt;=n; ++i){
                <span class="hljs-keyword">int</span> temp = search(n-i*i);
                <span class="hljs-keyword">if</span>(temp+<span class="hljs-number">1</span>&lt;result) result = temp+<span class="hljs-number">1</span>;
                }

                <span class="hljs-keyword">return</span> result;
                }
                }

                <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> FileNotFoundException</span>{
                Scanner in = <span class="hljs-keyword">new</span> Scanner(<span class="hljs-keyword">new</span> File(<span class="hljs-string">"input.txt"</span>));

                <span class="hljs-comment">//read input process</span>
                <span class="hljs-keyword">int</span> n = in.nextInt();
                <span class="hljs-keyword">while</span>(n!=-<span class="hljs-number">1</span>){
                <span class="hljs-comment">//calculate n</span>
                <span class="hljs-keyword">long</span> start = System.nanoTime();

                Perfect perfect = <span class="hljs-keyword">new</span> Perfect();
                System.out.print(n +<span class="hljs-string">" RESULT: "</span>+perfect.search(n) );

                <span class="hljs-keyword">long</span> end = System.nanoTime();
                System.out.println(<span class="hljs-string">" TIME: "</span>+(end-start)/<span class="hljs-number">1000000</span>+<span class="hljs-string">"ms"</span>);

                n =in.nextInt();
                }

                in.close();
                }
                }
            </code></pre>
                <p>运行时间：</p><pre data-initialized="true" data-gclp-id="233"><code>3 RESULT: 3 TIME: 0ms
                4 RESULT: 1 TIME: 0ms
                5 RESULT: 2 TIME: 0ms
                6 RESULT: 3 TIME: 0ms
                7 RESULT: 4 TIME: 0ms
                8 RESULT: 2 TIME: 0ms
                9 RESULT: 1 TIME: 0ms
                10 RESULT: 2 TIME: 0ms
                21 RESULT: 3 TIME: 0ms
                31 RESULT: 4 TIME: 0ms
                41 RESULT: 2 TIME: 7ms
                51 RESULT: 3 TIME: 241ms
                61 RESULT: 2 TIME: 7427ms
            </code></pre>
                <h2 id="cache优化">Cache优化</h2><pre data-initialized="true" data-gclp-id="234"><code class="lang-java">
                <span class="hljs-keyword">import</span> java.io.*;
                <span class="hljs-keyword">import</span> java.util.*;

                <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Perfect</span></span>{
                HashMap&lt;Integer, Integer&gt; cache;

                Perfect(){
                cache = <span class="hljs-keyword">new</span> HashMap&lt;Integer,Integer&gt;(); <span class="hljs-comment">// cache the cacluated n</span>
                }

                <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">search</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span>{
                <span class="hljs-comment">// input: n</span>
                <span class="hljs-comment">// output: the MIN number of perfect numbers summed as n</span>
                <span class="hljs-keyword">if</span>(cache.containsKey(n)) <span class="hljs-keyword">return</span> cache.get(n);

                <span class="hljs-keyword">int</span> result = n;

                <span class="hljs-comment">//        System.out.println(n);</span>

                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>; i*i&lt;=n; ++i){
                <span class="hljs-keyword">int</span> temp = search(n-i*i);
                <span class="hljs-keyword">if</span>(temp+<span class="hljs-number">1</span>&lt;result) result = temp+<span class="hljs-number">1</span>;
                }

                cache.put(n, result);
                <span class="hljs-keyword">return</span> result;
                }
                }

                <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> FileNotFoundException</span>{
                Scanner in = <span class="hljs-keyword">new</span> Scanner(<span class="hljs-keyword">new</span> File(<span class="hljs-string">"input.txt"</span>));

                <span class="hljs-comment">//read input process</span>
                <span class="hljs-keyword">int</span> n = in.nextInt();
                <span class="hljs-keyword">while</span>(n!=-<span class="hljs-number">1</span>){
                <span class="hljs-comment">//calculate n</span>
                <span class="hljs-keyword">long</span> start = System.nanoTime();

                Perfect perfect = <span class="hljs-keyword">new</span> Perfect();
                System.out.print(n +<span class="hljs-string">" RESULT: "</span>+perfect.search(n) );

                <span class="hljs-keyword">long</span> end = System.nanoTime();
                System.out.println(<span class="hljs-string">" TIME: "</span>+(end-start)/<span class="hljs-number">1000000</span>+<span class="hljs-string">"ms"</span>);

                n =in.nextInt();
                }

                in.close();
                }
                }
            </code></pre>
                <p>结果</p><pre data-initialized="true" data-gclp-id="235"><code>
                3 RESULT: 3 TIME: 0ms
                4 RESULT: 1 TIME: 0ms
                5 RESULT: 2 TIME: 0ms
                6 RESULT: 3 TIME: 0ms
                7 RESULT: 4 TIME: 0ms
                8 RESULT: 2 TIME: 0ms
                9 RESULT: 1 TIME: 0ms
                10 RESULT: 2 TIME: 0ms
                21 RESULT: 3 TIME: 0ms
                31 RESULT: 4 TIME: 0ms
                41 RESULT: 2 TIME: 0ms
                51 RESULT: 3 TIME: 0ms
                61 RESULT: 2 TIME: 0ms
                71 RESULT: 4 TIME: 0ms
                81 RESULT: 1 TIME: 0ms
                91 RESULT: 3 TIME: 0ms
                101 RESULT: 2 TIME: 0ms
            </code></pre>
                <p>解决栈溢出</p><pre data-initialized="true" data-gclp-id="236"><code class="lang-java">
                <span class="hljs-keyword">import</span> java.io.*;
                <span class="hljs-keyword">import</span> java.util.*;

                <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Perfect</span></span>{
                HashMap&lt;Integer, Integer&gt; cache;

                Perfect(){
                cache = <span class="hljs-keyword">new</span> HashMap&lt;Integer,Integer&gt;(); <span class="hljs-comment">// cache the cacluated n</span>
                }

                <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">search</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span>{
                <span class="hljs-comment">// input: n</span>
                <span class="hljs-comment">// output: the MIN number of perfect numbers summed as n</span>
                <span class="hljs-keyword">if</span>(cache.containsKey(n)) <span class="hljs-keyword">return</span> cache.get(n);

                <span class="hljs-keyword">int</span> result = n;

                <span class="hljs-comment">//        System.out.println(n);</span>

                <span class="hljs-keyword">int</span> ceiling = (<span class="hljs-keyword">int</span>)Math.pow(n,<span class="hljs-number">0.5</span>);
                <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=ceiling; i&gt;<span class="hljs-number">0</span>; --i){
                <span class="hljs-keyword">int</span> temp = search(n-i*i);
                <span class="hljs-keyword">if</span>(temp+<span class="hljs-number">1</span>&lt;result) result = temp+<span class="hljs-number">1</span>;
                }

                cache.put(n, result);
                <span class="hljs-keyword">return</span> result;
                }
                }

                <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> FileNotFoundException</span>{
                Scanner in = <span class="hljs-keyword">new</span> Scanner(<span class="hljs-keyword">new</span> File(<span class="hljs-string">"input.txt"</span>));

                <span class="hljs-comment">//read input process</span>
                <span class="hljs-keyword">int</span> n = in.nextInt();
                <span class="hljs-keyword">while</span>(n!=-<span class="hljs-number">1</span>){
                <span class="hljs-comment">//calculate n</span>
                <span class="hljs-keyword">long</span> start = System.nanoTime();

                Perfect perfect = <span class="hljs-keyword">new</span> Perfect();
                System.out.print(n +<span class="hljs-string">" RESULT: "</span>+perfect.search(n) );

                <span class="hljs-keyword">long</span> end = System.nanoTime();
                System.out.println(<span class="hljs-string">" TIME: "</span>+(end-start)/<span class="hljs-number">1000000</span>+<span class="hljs-string">"ms"</span>);

                n =in.nextInt();
                }

                in.close();
                }
                }
            </code></pre>
                <p>输出结果</p><pre data-initialized="true" data-gclp-id="237"><code>3 RESULT: 3 TIME: 0ms
                4 RESULT: 1 TIME: 0ms
                5 RESULT: 2 TIME: 0ms
                6 RESULT: 3 TIME: 0ms
                7 RESULT: 4 TIME: 0ms
                8 RESULT: 2 TIME: 0ms
                9 RESULT: 1 TIME: 0ms
                10 RESULT: 2 TIME: 0ms
                21 RESULT: 3 TIME: 0ms
                31 RESULT: 4 TIME: 0ms
                41 RESULT: 2 TIME: 0ms
                51 RESULT: 3 TIME: 0ms
                61 RESULT: 2 TIME: 0ms
                71 RESULT: 4 TIME: 0ms
                81 RESULT: 1 TIME: 0ms
                91 RESULT: 3 TIME: 0ms
                101 RESULT: 2 TIME: 0ms
                1001 RESULT: 3 TIME: 4ms
                10001 RESULT: 2 TIME: 55ms
                100001 RESULT: 3 TIME: 913ms</code></pre>
                <h2 id="剪枝">剪枝</h2><p>ceiling剪枝</p><pre data-initialized="true" data-gclp-id="238"><code class="lang-java">
                <span class="hljs-keyword">import</span> java.io.*;
                <span class="hljs-keyword">import</span> java.util.*;


                <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Perfect</span></span>{
                HashMap&lt;Integer, Integer&gt; cache;

                Perfect(){
                cache = <span class="hljs-keyword">new</span> HashMap&lt;Integer,Integer&gt;(); <span class="hljs-comment">// cache the cacluated n</span>
                }

                <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">search</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span>{
                <span class="hljs-comment">// input: n</span>
                <span class="hljs-comment">// output: the MIN number of perfect numbers summed as n</span>
                <span class="hljs-keyword">if</span>(cache.containsKey(n)) <span class="hljs-keyword">return</span> cache.get(n);

                <span class="hljs-keyword">int</span> result = n;

                <span class="hljs-keyword">int</span> ceiling = (<span class="hljs-keyword">int</span>)Math.pow(n,<span class="hljs-number">0.5</span>);

                <span class="hljs-keyword">if</span>(ceiling*ceiling==n) result = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = ceiling; i &gt; <span class="hljs-number">0</span>; --i) {
                <span class="hljs-keyword">int</span> temp = search(n - i * i);
                <span class="hljs-keyword">if</span> (temp + <span class="hljs-number">1</span> &lt; result) result = temp + <span class="hljs-number">1</span>;
                <span class="hljs-keyword">if</span>(temp == <span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>;
                }
                }

                cache.put(n, result);
                <span class="hljs-keyword">return</span> result;
                }
                }

                <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> FileNotFoundException</span>{
                Scanner in = <span class="hljs-keyword">new</span> Scanner(<span class="hljs-keyword">new</span> File(<span class="hljs-string">"input.txt"</span>));

                <span class="hljs-comment">//read input process</span>
                <span class="hljs-keyword">int</span> n = in.nextInt();
                <span class="hljs-keyword">while</span>(n!=-<span class="hljs-number">1</span>){
                <span class="hljs-comment">//calculate n</span>
                <span class="hljs-keyword">long</span> start = System.nanoTime();

                Perfect perfect = <span class="hljs-keyword">new</span> Perfect();
                System.out.print(n +<span class="hljs-string">" RESULT: "</span>+perfect.search(n) );

                <span class="hljs-keyword">long</span> end = System.nanoTime();
                System.out.println(<span class="hljs-string">" TIME: "</span>+(end-start)/<span class="hljs-number">1000000</span>+<span class="hljs-string">"ms"</span>);

                n =in.nextInt();
                }

                in.close();
                }
                }
            </code></pre>
                <p>运行时间</p><pre data-initialized="true" data-gclp-id="239"><code>3 RESULT: 3 TIME: 0ms
                4 RESULT: 1 TIME: 0ms
                5 RESULT: 2 TIME: 0ms
                6 RESULT: 3 TIME: 0ms
                7 RESULT: 4 TIME: 0ms
                8 RESULT: 2 TIME: 0ms
                9 RESULT: 1 TIME: 0ms
                10 RESULT: 2 TIME: 0ms
                21 RESULT: 3 TIME: 0ms
                31 RESULT: 4 TIME: 0ms
                41 RESULT: 2 TIME: 0ms
                51 RESULT: 3 TIME: 0ms
                61 RESULT: 2 TIME: 0ms
                71 RESULT: 4 TIME: 0ms
                81 RESULT: 1 TIME: 0ms
                91 RESULT: 3 TIME: 0ms
                101 RESULT: 2 TIME: 0ms
                1001 RESULT: 3 TIME: 3ms
                10001 RESULT: 2 TIME: 0ms
                100001 RESULT: 3 TIME: 737ms
                1000001 RESULT: 2 TIME: 0ms</code></pre>
                <h2 id="深度剪枝">深度剪枝</h2><pre data-initialized="true" data-gclp-id="240"><code class="lang-java">
                <span class="hljs-keyword">import</span> java.io.*;
                <span class="hljs-keyword">import</span> java.util.*;

                <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Perfect</span></span>{
                HashMap&lt;Integer, Integer&gt; cache;
                <span class="hljs-keyword">int</span> best;

                Perfect(){
                cache = <span class="hljs-keyword">new</span> HashMap&lt;Integer,Integer&gt;(); <span class="hljs-comment">// cache the cacluated n</span>
                }

                <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">search</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> depth)</span></span>{
                <span class="hljs-comment">// input: n</span>
                <span class="hljs-comment">// output: the MIN number of perfect numbers summed as n</span>

                <span class="hljs-keyword">if</span>(depth&gt;best) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<span class="hljs-comment">// short cut</span>

                <span class="hljs-keyword">if</span>(cache.containsKey(n)) <span class="hljs-keyword">return</span> cache.get(n);

                <span class="hljs-keyword">int</span> result = -<span class="hljs-number">1</span>;

                <span class="hljs-keyword">int</span> ceiling = (<span class="hljs-keyword">int</span>)Math.pow(n,<span class="hljs-number">0.5</span>);

                <span class="hljs-keyword">if</span>(ceiling*ceiling==n){
                result = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">if</span>(depth&lt;best) best = depth;
                }
                <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = ceiling; i &gt; <span class="hljs-number">0</span>; --i) {
                <span class="hljs-keyword">int</span> temp = search(n - i * i, depth+<span class="hljs-number">1</span>);
                <span class="hljs-keyword">if</span>(temp==-<span class="hljs-number">1</span>) <span class="hljs-keyword">continue</span>;

                <span class="hljs-keyword">if</span> (result == -<span class="hljs-number">1</span> || temp + <span class="hljs-number">1</span> &lt; result) result = temp + <span class="hljs-number">1</span>;
                <span class="hljs-keyword">if</span>(temp+depth&lt;best) best = temp+depth;
                <span class="hljs-keyword">if</span>(temp == <span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>;
                }
                }

                <span class="hljs-keyword">if</span>(result != -<span class="hljs-number">1</span>) cache.put(n, result);
                <span class="hljs-keyword">return</span> result;
                }
                }

                <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> FileNotFoundException</span>{
                Scanner in = <span class="hljs-keyword">new</span> Scanner(<span class="hljs-keyword">new</span> File(<span class="hljs-string">"input.txt"</span>));

                <span class="hljs-comment">//read input process</span>
                <span class="hljs-keyword">int</span> n = in.nextInt();
                Perfect perfect = <span class="hljs-keyword">new</span> Perfect();

                <span class="hljs-keyword">while</span>(n!=-<span class="hljs-number">1</span>){
                <span class="hljs-comment">//calculate n</span>
                <span class="hljs-keyword">long</span> start = System.nanoTime();

                perfect.best = n;

                System.out.print(n +<span class="hljs-string">" RESULT: "</span>+perfect.search(n, <span class="hljs-number">1</span>) );

                <span class="hljs-keyword">long</span> end = System.nanoTime();
                System.out.println(<span class="hljs-string">" TIME: "</span>+(end-start)/<span class="hljs-number">1000000</span>+<span class="hljs-string">"ms"</span>);

                n =in.nextInt();
                }

                in.close();
                }
                }
            </code></pre>
                <p>运行时间</p><pre data-initialized="true" data-gclp-id="241"><code>3 RESULT: 3 TIME: 0ms
                4 RESULT: 1 TIME: 0ms
                5 RESULT: 2 TIME: 0ms
                6 RESULT: 3 TIME: 0ms
                7 RESULT: 4 TIME: 0ms
                8 RESULT: 2 TIME: 0ms
                9 RESULT: 1 TIME: 0ms
                10 RESULT: 2 TIME: 0ms
                21 RESULT: 3 TIME: 0ms
                31 RESULT: 4 TIME: 0ms
                41 RESULT: 2 TIME: 0ms
                51 RESULT: 3 TIME: 0ms
                61 RESULT: 2 TIME: 0ms
                71 RESULT: 4 TIME: 0ms
                81 RESULT: 1 TIME: 0ms
                91 RESULT: 3 TIME: 0ms
                101 RESULT: 2 TIME: 0ms
                1001 RESULT: 3 TIME: 0ms
                10001 RESULT: 2 TIME: 0ms
                100001 RESULT: 3 TIME: 40ms
                1000001 RESULT: 2 TIME: 0ms
                10000001 RESULT: 3 TIME: 6653ms
                100000001 RESULT: 2 TIME: 0ms</code></pre>
                <p>预测剪枝</p><pre data-initialized="true" data-gclp-id="242"><code class="lang-java">
                <span class="hljs-keyword">import</span> java.io.*;
                <span class="hljs-keyword">import</span> java.util.*;


                <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Perfect</span></span>{
                HashMap&lt;Integer, Integer&gt; cache;
                <span class="hljs-keyword">int</span> best;

                Perfect(){
                cache = <span class="hljs-keyword">new</span> HashMap&lt;Integer,Integer&gt;(); <span class="hljs-comment">// cache the cacluated n</span>
                }

                <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">search</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n, <span class="hljs-keyword">int</span> depth)</span></span>{
                <span class="hljs-comment">// input: n</span>
                <span class="hljs-comment">// output: the MIN number of perfect numbers summed as n</span>

                <span class="hljs-keyword">if</span>(depth&gt;best) <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<span class="hljs-comment">// short cut</span>

                <span class="hljs-keyword">if</span>(cache.containsKey(n)) <span class="hljs-keyword">return</span> cache.get(n);

                <span class="hljs-keyword">int</span> result = -<span class="hljs-number">1</span>;

                <span class="hljs-keyword">int</span> ceiling = (<span class="hljs-keyword">int</span>)Math.pow(n,<span class="hljs-number">0.5</span>);

                <span class="hljs-keyword">if</span>(ceiling*ceiling==n){
                result = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">if</span>(depth&lt;best) best = depth;
                }
                <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// at least need another 2</span>

                <span class="hljs-keyword">if</span>( depth+<span class="hljs-number">1</span> &lt; best) {

                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = ceiling; i &gt; <span class="hljs-number">0</span>; --i) {
                <span class="hljs-keyword">int</span> temp = search(n - i * i, depth + <span class="hljs-number">1</span>);
                <span class="hljs-keyword">if</span> (temp == -<span class="hljs-number">1</span>) <span class="hljs-keyword">continue</span>;

                <span class="hljs-keyword">if</span> (result == -<span class="hljs-number">1</span> || temp + <span class="hljs-number">1</span> &lt; result) result = temp + <span class="hljs-number">1</span>;
                <span class="hljs-keyword">if</span> (temp + depth &lt; best) best = temp + depth;
                <span class="hljs-keyword">if</span> (temp == <span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>;
                }
                }
                }

                <span class="hljs-keyword">if</span>(result != -<span class="hljs-number">1</span>) cache.put(n, result);
                <span class="hljs-keyword">return</span> result;
                }
                }

                <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> FileNotFoundException</span>{
                Scanner in = <span class="hljs-keyword">new</span> Scanner(<span class="hljs-keyword">new</span> File(<span class="hljs-string">"input.txt"</span>));

                <span class="hljs-comment">//read input process</span>
                <span class="hljs-keyword">int</span> n = in.nextInt();
                Perfect perfect = <span class="hljs-keyword">new</span> Perfect();

                <span class="hljs-keyword">while</span>(n!=-<span class="hljs-number">1</span>){
                <span class="hljs-comment">//calculate n</span>
                <span class="hljs-keyword">long</span> start = System.nanoTime();

                <span class="hljs-keyword">if</span>(n==<span class="hljs-number">0</span>) perfect.best = <span class="hljs-number">1</span>;
                <span class="hljs-keyword">else</span> perfect.best = n;
                perfect.search(n, <span class="hljs-number">1</span>);

                System.out.print(n +<span class="hljs-string">" RESULT: "</span>+ perfect.best );

                <span class="hljs-keyword">long</span> end = System.nanoTime();
                System.out.println(<span class="hljs-string">" TIME: "</span>+(end-start)/<span class="hljs-number">1000000</span>+<span class="hljs-string">"ms"</span>);

                n =in.nextInt();
                }

                in.close();
                }
                }
            </code></pre>
                <p>运行时间</p><pre data-initialized="true" data-gclp-id="243"><code>
                3 RESULT: 3 TIME: 0ms
                4 RESULT: 1 TIME: 0ms
                5 RESULT: 2 TIME: 0ms
                6 RESULT: 3 TIME: 0ms
                7 RESULT: 4 TIME: 0ms
                8 RESULT: 2 TIME: 0ms
                9 RESULT: 1 TIME: 0ms
                10 RESULT: 2 TIME: 0ms
                21 RESULT: 3 TIME: 0ms
                31 RESULT: 4 TIME: 0ms
                41 RESULT: 2 TIME: 0ms
                51 RESULT: 3 TIME: 0ms
                61 RESULT: 2 TIME: 0ms
                71 RESULT: 4 TIME: 0ms
                81 RESULT: 1 TIME: 0ms
                91 RESULT: 3 TIME: 0ms
                101 RESULT: 2 TIME: 0ms
                1001 RESULT: 3 TIME: 0ms
                10001 RESULT: 2 TIME: 0ms
                100001 RESULT: 3 TIME: 0ms
                1000001 RESULT: 2 TIME: 0ms
                10000001 RESULT: 3 TIME: 2ms
                100000001 RESULT: 2 TIME: 0ms
                1000000001 RESULT: 3 TIME: 5ms</code></pre>
                <h2 id="breath-first-search">Breath first search</h2><pre data-initialized="true" data-gclp-id="244"><code class="lang-java">
                <span class="hljs-keyword">import</span> java.io.*;
                <span class="hljs-keyword">import</span> java.util.*;


                <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Perfect</span></span>{

                <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span>{
                LinkedList&lt;Integer&gt; processing = <span class="hljs-keyword">new</span> LinkedList&lt;Integer&gt;();
                processing.add(n);
                processing.add(-<span class="hljs-number">1</span>);

                HashSet&lt;Integer&gt; used = <span class="hljs-keyword">new</span> HashSet&lt;Integer&gt;();

                <span class="hljs-keyword">int</span> need = <span class="hljs-number">1</span>;

                <span class="hljs-keyword">while</span>(processing.isEmpty()==<span class="hljs-keyword">false</span>) {
                <span class="hljs-keyword">int</span> temp = processing.pollFirst();
                <span class="hljs-keyword">if</span> (temp &lt; <span class="hljs-number">0</span> ) {
                processing.addLast(temp - <span class="hljs-number">1</span>);
                need++;
                }<span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">int</span> ceiling = (<span class="hljs-keyword">int</span>) Math.pow(temp, <span class="hljs-number">0.5</span>);
                <span class="hljs-keyword">if</span> (ceiling * ceiling == temp) <span class="hljs-keyword">break</span>;

                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = ceiling; i &gt; <span class="hljs-number">0</span>; --i) {
                <span class="hljs-keyword">if</span> (used.add(temp - i * i)) processing.addLast(temp - i * i);
                }
                }
                }
                <span class="hljs-keyword">return</span> need;
                }
                }

                <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Solution</span> </span>{
                <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> FileNotFoundException</span>{
                Scanner in = <span class="hljs-keyword">new</span> Scanner(<span class="hljs-keyword">new</span> File(<span class="hljs-string">"input.txt"</span>));

                <span class="hljs-comment">//read input process</span>
                <span class="hljs-keyword">int</span> n = in.nextInt();
                Perfect perfect = <span class="hljs-keyword">new</span> Perfect();

                <span class="hljs-keyword">while</span>(n!=-<span class="hljs-number">1</span>){
                <span class="hljs-comment">//calculate n</span>
                <span class="hljs-keyword">long</span> start = System.nanoTime();

                perfect.best = n;

                <span class="hljs-comment">//            System.out.print(n +" RESULT: "+perfect.search(n, 1) );</span>

                System.out.print(n +<span class="hljs-string">" RESULT: "</span>+perfect.bfs(n) );
                <span class="hljs-keyword">long</span> end = System.nanoTime();
                System.out.println(<span class="hljs-string">" TIME: "</span>+(end-start)/<span class="hljs-number">1000000</span>+<span class="hljs-string">"ms"</span>);

                n =in.nextInt();
                }

                in.close();
                }
                }
            </code></pre>
                <p>运行时间</p><pre data-initialized="true" data-gclp-id="245"><code>3 RESULT: 3 TIME: 0ms
                4 RESULT: 1 TIME: 0ms
                5 RESULT: 2 TIME: 0ms
                6 RESULT: 3 TIME: 0ms
                7 RESULT: 4 TIME: 0ms
                8 RESULT: 2 TIME: 0ms
                9 RESULT: 1 TIME: 0ms
                10 RESULT: 2 TIME: 0ms
                21 RESULT: 3 TIME: 0ms
                31 RESULT: 4 TIME: 0ms
                41 RESULT: 2 TIME: 0ms
                51 RESULT: 3 TIME: 0ms
                61 RESULT: 2 TIME: 0ms
                71 RESULT: 4 TIME: 0ms
                81 RESULT: 1 TIME: 0ms
                91 RESULT: 3 TIME: 0ms
                101 RESULT: 2 TIME: 0ms
                1001 RESULT: 3 TIME: 0ms
                10001 RESULT: 2 TIME: 0ms
                100001 RESULT: 3 TIME: 17ms
                1000001 RESULT: 2 TIME: 0ms
                10000001 RESULT: 3 TIME: 3392ms
                100000001 RESULT: 2 TIME: 0ms
            </code></pre>
                <h2 id="更快方法？">更快方法？</h2><p>如果我们运行程序很多次，会发现结果都是在4以内。实际上数学上是能够证明最多4个的。
                因此每次可以只针对能否找到3个来求解。</p><h2 id="扩展思考">扩展思考</h2><p>相关题目</p><ul><li>立方求和
            </li></ul>
                <p>总结</p><ul><li>运行时间的统计方法
            </li></ul>

            </section>
        </div>
        <div class="search-results">
            <div class="has-results">
                <h1 class="search-results-title">
                    <span class="search-results-count"></span>
                    results matching "<span class="search-query"></span>"
                </h1>
                <ul class="search-results-list">

                </ul>
            </div>
            <div class="no-results">
                <h1 class="search-results-title">
                    No results matching "<span class="search-query"></span>"
                </h1>
            </div>
        </div>
    </div>

</div>